<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Europe & Asia Map Quiz</title>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #map-container {
      width: 100%;
      height: 600px;
      position: relative;
    }
    svg {
      border: 1px solid #ddd;
      width: 100%;
      height: 100%;
    }
    path {
      fill: #f0f0f0;
      stroke: #333;
      stroke-width: 0.5px;
      transition: all 0.3s ease;
    }
    path:hover {
      fill: steelblue;
      cursor: pointer;
    }
    .guessed {
      stroke: #0077cc !important;
      stroke-width: 3px !important;
      fill-opacity: 1 !important;
    }
    #country-list {
      list-style: none;
      padding: 0;
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      width: 100%;
    }
    #country-list li {
      background-color: #fff;
      border: 1px solid #ddd;
      padding: 8px 15px;
      cursor: pointer;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      user-select: none;
      position: relative;
      z-index: 2;
    }
    .matched {
      background-color: lightgreen;
      border-color: green;
      color: gray;
      cursor: not-allowed;
    }
    .selected {
      background-color: lightblue;
    }
    .error {
      color: red;
    }
    #scoreboard {
      margin-top: 10px;
      font-size: 1.1em;
    }
    #restart-button {
      margin-top: 10px;
      padding: 8px 16px;
      font-size: 1em;
      cursor: pointer;
      background-color: #0077cc;
      color: white;
      border: none;
      border-radius: 5px;
    }
    #restart-button:hover {
      background-color: #005fa3;
    }
  </style>
</head>
<body>
  <div id="map-container">
    <svg></svg>
  </div>
  <ul id="country-list"></ul>
  <div id="feedback"></div>
  <div id="scoreboard">
    <strong>Score:</strong> <span id="score">0</span> |
    <strong>Attempts:</strong> <span id="attempts">0</span>
  </div>
  <button id="restart-button">Restart Game</button>
  <div id="victory-message" style="display: none; font-size: 1.3em; color: green; margin-top: 10px;"></div>

  <script>
    const mapContainer = d3.select('#map-container');
    const svg = d3.select('svg');
    const width = mapContainer.node().getBoundingClientRect().width;
    const height = mapContainer.node().getBoundingClientRect().height;

    const projection = d3.geoMercator()
      .center([60, 40]) // מרכז המפה
      .scale(400)
      .translate([width / 2, height / 2]);

    const path = d3.geoPath().projection(projection);

    let selectedCountry = null;
    let score = 0;
    let attempts = 0;
    let correctGuesses = 0;

    d3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json')
      .then(data => {
        const countries = topojson.feature(data, data.objects.countries).features;

        // רשימת קודים נומריים של מדינות אירופה ואסיה
        const europeAsiaISO = [
          4, 8, 51, 31, 40, 112, 56, 96, 100, 854, 124, 152, 156, 196, 203,
          208, 233, 231, 246, 250, 268, 276, 300, 348, 352, 356, 360, 364,
          368, 372, 376, 398, 417, 428, 422, 440, 442, 458, 470, 498, 499,
          504, 528, 578, 586, 616, 620, 642, 643, 682, 688, 702, 703, 705,
          710, 724, 752, 756, 760, 762, 764, 792, 804, 807, 860, 862, 887
        ];

        const filteredCountries = countries.filter(d => europeAsiaISO.includes(+d.id));

        const countryPaths = svg.selectAll('path')
          .data(filteredCountries)
          .enter().append('path')
          .attr('d', path)
          .attr('id', d => 'country-' + d.id);

        const countryList = d3.select('#country-list');
        const countryNames = filteredCountries.map(d => ({
          id: d.id,
          name: d.properties.name,
          centroid: path.centroid(d)
        }));

        const countryItems = countryList.selectAll('li')
          .data(countryNames)
          .enter().append('li')
          .attr('id', d => 'country-' + d.id)
          .text(d => d.name)
          .on('click', function(d) {
            if (!d3.select(this).classed('matched')) {
              countryList.selectAll('li').classed('selected', false);
              selectedCountry = d;
              d3.select(this).classed('selected', true);
              d3.select('#feedback').text('');
            }
          });

        countryPaths.on('click', function(d) {
          const feedbackElement = d3.select('#feedback');

          if (selectedCountry) {
            attempts++;
            d3.select('#attempts').text(attempts);

            if (d.id === selectedCountry.id) {
              score
::contentReference[oaicite:2]{index=2}
 
